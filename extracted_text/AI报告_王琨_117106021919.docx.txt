大数据在智能交通领域的应用研究























王琨

王琨学生姓名__________________________



117106021919

117106021919学生学号__________________________







___2017___年 _11_月 ___日

摘 要

智能交通系统是未来交通系统的发展方向，它将先进的信息技术、数据通讯传输技术、电子传感技术、控制技术和计算机技术等有效地集成运用起来，从而建立起一种在大范围内、全方位发挥作用的，实时、准确、高效的综合交通运输管理系统。

信息通讯技术的发展，使交通运输从数据贫乏转向数据丰富的大数据时代。交通系统产生的数据量十分巨大，想要发展好智能交通，就需要对庞大的数据进行处理，因此有必要在智能交通领域引入大数据解决方案。

关键词：智能交通；大数据；人工智能






ABSTRACT

Intelligent transportation system is the development direction of the future transportation system. It uses advanced information technology, data communication transmission technology, electronic sensing technology, control technology and computer technology to effectively integrate and use, so as to establish a large-scale, All-round, real-time, accurate and efficient integrated transportation management system.

The development of information and communication technologies has shifted transport from the data-poor to the data-rich era of big data. The amount of data generated by the transportation system is huge. If you want to develop intelligent transportation, you need to process huge data. Therefore, it is necessary to introduce a big data solution in the field of intelligent transportation.

KEY WORDS: Smart Transportation; Big Data; Artificial Intelligence






绪论

 研究背景和意义

随着信息通讯技术的发展，交通运输正逐渐从数据贫乏时代转向数据丰富的大数据时代。智能交通系统建设规模不断扩大，随之而来的系统数据、交通检测数据、交通监控数据、交通服务数据等不同类型的海量数据构成了大数据。智能交通是解决城市交通拥堵，改善城市出行条件的重要途径。大数据时代的到来及

物联网、云计算、互联网等技术的发展给智能交通注入新的技术内涵，带来重大变革。据统计，北京市6万余辆出租车一天就会产生数亿条GPS数据，车牌识别、交通监控视频等数据量更大，交通相关的数据量级已从TB级别跃升到PB级别。越来越庞大的数据量对智能交通系统的运营和管理都产生了巨大的影响。面对众多的交通大数据，如何对其进行准确、高效的处理和分析及预测，挖掘其中蕴含的深层应用，做出即时和正确的交通诱导和疏通以有效改善实际交通拥堵状况成为智能化交通信息处理分析的核心内容。数据是驱动智能交通发展的基础，大数据技术的开发利用将为智能交通的进一步发展带来质的飞跃。

 国内外研究现状

目前，国际智能交通领域的车路协同系统、公众出行便捷服务、车联网等热点技术领域都在广泛研究和应用大数据技术。在2013年10月第20届世界智能交通大会上就提出了关于交通大数据的相关研究，研究表明大数据技术的研究已经在交通管理、交通安全、交通应急、出行智能化服务等方面开始占据市场。目前研究者们已提出许多有关大数据处理技术，例如Google较早开发了GFS和MapReduce，微软的分布式计算平台cosmos，Facebook，集群处理Dryad，并行处理Impala等都已成为研究热点。




基于大数据的智能交通体系架构

 大数据在智能交通领域的应用

交通大数据的活化应用对交通的发展将带来巨大的变化，这主要体现在大数据技术的实时性、分布性、高效性及预测性方面。

①实时性。传统的海量数据模糊查询和统计分析无法达到交通实时性的需求，大数据能够实时地对交通大数据分析、处理，提供秒级响应，帮助人们在海量的交通数据中快速发现交通异常，并定位症结，方便交通管理，使交通运行得更加合理。

②分布性。传统的数据应用多为单表挖掘分析，一旦涉及到跨表关联就会因效率问题而无能为力，大数据的分布式并行处理擅长复杂的块表关联分析，推动数据串并关联，提高数据处理能力，支撑高并发多用户访问，协同人们在交通紧急事件中多方协作、快速处置。

③高效性。高效的交通大数据挖掘能力，能够快速发现海量交通数据中的内在关联规律，进而提高交通运营效率以及路网的通行能力。

④预测性。大数据技术较高的预测能力可降低交通状态误报和漏报的概率，通过建立区域交通状态的监测及预测模型，共享交通运行与路况环境数据，随时对交通的动态性进行实时监控，帮助驾驶者及用户预先了解交通拥堵状况，避开拥堵路段。

 交通大数据处理平台

交通大数据处理基本流程与传统数据处理流程基本相似，整个处理流程可以概括为数据采集、数据导入和预处理、数据存储、数据处理和结果展现。由于交通大数据要处理大量的、非结构化的数据，如视频数据及监控数据，而且要求处理的强实时性，所以在各个处理环节中采用MapReduce分布式计算框架以及实时流数据处理计算框架，数据存储用支持文本和图像存储，面向列、可伸缩，支持事务以及B树范围查询和排序的分布式数据库HBase和分布式文件存储系统HDFS(Hadoop Distributed FileSystem)。依据大数据处理流程及交通数据处理的特性，整个平台的构建分两部分，依次为对交通大数据离线批处理、深度挖掘的Hadoop生态系统和对交通大数据进行强实时流式计算的storm处理系统，平台搭建如图1所示。



图1 交通大数据处理平台



使用构建在Hadoop生态系统上的分布式日志处理系统Chukwa收集交通数据源，用数据同步工具Sqoop实现各种交通数据源和Hadoop分布式文件系统HDFS间的数据转移和传输。鉴于交通流数据处理的强实时性，系统构建对Hadoop平台进行了扩展，引入实时犬数据流处理系统Storm。因此在交通大数据处理层包含基于Hadoop的分布式离线处理计算框架和基于Storm的实时流数据处理计算框架．其中，MapReduce通过map和reduce两个步骤实现交通数据的并行处理；Impala提供SQL语义，对存储在Hadoop的HDFS和HBase中的PB级交通大数据实现交互式的快速查询；利用Mahout提供的可扩展的机器学习和数据挖掘的分

布式框架，实现交通大数据的并行分析与挖掘。Storm平台克服了Hadoop平台不能有效适应实时数据处理的缺陷，提供全内存计算，实现对流式交通数据的实时处理，它提供的输人流组件Spout负责将数据传递给另一个组件Bolt，Bolt执行任务，如交通流数据的过滤、计算、访问文件／数据库等，并创建新的流作为下一个Bolt的输人流．数据展现层利用大数据分析工具Karmasphere实现结果数据的可视化，迅速有效地简化提炼数据流，提供具有交互功能的动态图表，帮助人们探索和解释复杂的数据，理解和分析数据的内涵与特征，更好地从复杂数据中得到新的发现。

 交通大数据处理体系框架

交通数据不仅量大而且异构源多，实时性要求强，处理速度快，是典型的大数据，如何利用好这些多源的大量数据为交通决策与诱导提供便利，有效缓解交通拥堵是交通领域的难题，也是智能交通首要解决的问题．在综合考虑了交通数据的特性以及应用需求的基础上，本文设计了如图2所示的交通大数据处理体系框架．该框架基于图1所示的交通大数据处理平台设计，包含四层结构，分别为数据源层、数据处理层、知识层以及应用层。

①数据源层。交通异构数据源有结构化的数据，大部分都是非结构化的数据，这些数据源主要包括无线射频识别数据(radio frequency identification，RFID)、视频监控、卡扣数据(包括ETC、交叉口信号灯等)、GPS(global positioning system)轨迹数据、IC卡刷卡数据、交通应用服务数据等。

②数据处理层。数据处理层是大数据处理体系框架的核心层，Sqoop整合数据源数据，存储于分布式数据库HBase中。这里采用基于HDFS的HBase和Impala的存储系统，Impala提供实时的交互式SQL。大数据查询功能，直接从HBase中用SELECT、JOIN和统计函数查询数据，实现快速的大数据存储和分析。

③知识层。交通大数据的处理就是要对数据进行深层分析、挖掘数据所蕴含的深层知识，寻找数据内部隐藏的规律。对交通视频及图像采用CUDA架构，快速提取其特征和摘要以备挖掘分析，对卡扣和应用服务数据及GPS等数据基于MapReduce计算模型用Mahout进行并行分析与挖掘，形成知识，为智能交通系统提供更高层的应用与管理．

④应用层。所有的研究都将归结于应用，大数据为智能交通的进一步发展起到了极大的促进作用，主要产生了以下几个方面的应用：交通拥堵自动检测，路网地图更新，交通供求分析，道路规划，交通费用预测，实时路况展现，交通异常检测，智能电子停车，出行信息服务，交通诱导等。



图2 交通大数据处理体系架构




大数据在智能交通中的应用举例

 基于大数据的公交线路OD矩阵推断方法简介

OD是指人们出行的起点和终点。OD矩阵可以反映人们的出行特征和方式，是交通规划和运营管理的重要依据。其中，公交线路OD矩阵反映了公交出行的时空分布特征，是城市公交线网优化以及公交运营调度的基础。

传统获取公交OD矩阵的方法是人工调查法。人工调查法得到的数据量有限，并且耗费大量的人力物力，代表性不强，不能反映真实的公交客流情况。为了节省人力物力，研究者开始利用刷卡数据进行OD矩阵的推断。对于OD矩阵推断的研究主要包括：上车站点推断、下车站点推断、换乘站点推断等。在上车站点推断中，最常用的方法就是聚类分析法。

 线路OD矩阵推断方法

线路OD矩阵推断方法即通过交通大数据的匹配来获得乘客的上车站点，基于出行链分析法和上车站点信息推断乘客下车站点，通过上车站点和下车站点获取乘客的出行OD，最后获得OD矩阵。交通大数据主要是乘坐公共交通产生的大量的刷卡数据和公交车辆行驶过程中产生的大量的报站数据。本研究所使用的数据主要包括IC卡刷卡数据(公交、地铁)、公交车辆报站数据。

 数据

所需数据主要是IC卡刷卡数据和公交车辆报站数据，数据结构如表1～表3所示。

表1 公交IC卡数据结构

字段

说明

Logcardid

卡号

Thtime

刷卡时间

Lineno

线路号

Busno

车牌号

Linename

线路名

表2 地铁IC卡数据结构

字段

说明

INC

IC卡卡号

地铁出口站点

出口站点名

地铁出口时间

出口刷卡时问

地铁进口站点

进口站点名

地铁进口时间

进口刷卡时间





表3 公交车辆报站数据结构

字段

说明

Buscode

车辆号

Routecode

线路号

Busstop

站点名

Adtime

进站／出站时间

Adflag

进站／出站标志



其中，地铁刷卡数据已包含进出站站点，只需对很少的部分缺失数据进行推断补充。公交刷卡数据和车辆报站数据在删除无效数据和补充缺失数据后，首先通过线路编号和车辆编号，确定刷卡记录的来源车辆，然后通过刷卡时间和报站时间的对应进行上车站点的判断。

 上车站点推断

经上述处理后的数据，利用数据匹配的方法推断上车站点。基本思想是：刷卡时间处于某个站的进出站时间之间，则此站为上车站点；刷卡时间处于两个相邻进站时问之问，求得刷卡时间和前出站时间以及后进站时问的差值，比较差值和阈值，小于阈值的较小差值所对应的站点为上车站点。参数定义如下：m为报站数据条数(满足与刷卡数据有相同车辆编号的条件)；k∈m，为符合时间条件的某条报站数据；d，为刷卡时间与前出站时间的差值；d2为刷卡时间与后进站时间的差值；t为时间差阈值。推断上车站点的算法流程如图3所示。

 下车站点推断

在获得乘客上车站点的前提下，本章基于出行链思想及站点信息、时空信息等提出了下车站点推断算法，此算法针对的是公交刷卡数据。由于地铁刷卡记录已包含下车站点，因此不需要进行推断。如果乘客在一天中既有公交出行，又有地铁出行，则将地铁刷卡记录作为已推断出下车站点的公交刷卡记录，帮助推断实际的公交出行下车站点。基本思想是：将每个卡号一天内的刷卡记录按照时间的先后顺序划分为一个单元。如果一个单元只有一条公交刷卡记录，则需要结合其他时间的刷卡记录根据相似出行链分析法来推断下车站点。如果有两条刷卡记录，且有相同线路，则两条刷卡记录的上车站点互为对方的下车站点；如果线路不同，则要根据线路信息和站点信判断下车站点。如果有多条刷卡记录，每两条相邻记录为一个子单元，根据只有两条刷卡记录的方法推断下车站点，然后以此类推获取所有刷卡记录的下车站点。

参数定义如下：di为后一条记录的上车站点与前一条线路中第，个站点之间的距离，j为一条线路中的站点数；为两个站点间的最短距离，m∈J；d为距离阈值。

推断下车站点的算法流程如图4所示。



图3 上车站点推断流程图








图4 下车站点推断流程图

 OD矩阵推断

获取OD矩阵首先要获取每个乘客的单次出行OD。基本思想是：若非换乘出行，一条刷卡记录中的上车站点为O，下车站点为D；若时间满足换乘条件，为换乘出行，则第一条刷卡记录的上车站点为0，最后一条刷卡记录的下车站点为D。现在认为，正常的一次出行最多为3次换乘，地铁之间的换乘不考虑。参数定义如下：T1，疋，瓦分别为所读取的相邻四条数据每相邻两条刷卡时间的差值；t为时间差阈值。推断线路OD的算法流程如图5所示。






图5 线路OD推断流程图