Abstract	工程硕士学位论文

























人工智能综述报告

推荐系统的研究及产业应用情况













学    号: 117106010722  

姓    名:     姚强      











1.研究的主要内容和意义

 1.1研究意义

随着人工智能、数据挖掘等相关领域的发展，网络上的信息服务正不断地向人性化、个性化、智能化方向发展，相关的推荐技术成为其中的关键组成部分。由于网络服务中供推荐系统使用的数据一般都具有高维、海量、稀疏的特点，这就为推荐系统的应用提出了挑战。首先，推荐系统是供网络用户直接使用的服务，推荐质量直接影响到用户对个性化服务的印象和评价，提供高精度的推荐一直都是推荐系统研究人员和服务提供商所努力的核心目标之一。然而数据的高维、稀疏使得系统产生有效推荐变得相对困难。其次，推荐系统作为一种在线服务，快捷高效地提供个性化推荐是人们所努力的另一个核心目标，因为这直接关系到用户的体验及其对系统的优劣评价。但是数据的高维、海量特性是推荐系统实时性要求所面临的主要挑战。此外，推荐系统需要收集、分析用户的习惯或兴趣爱好等涉及用户隐私的内容，随着人们对信息安全和隐私保护的日益重视，提供个性化推荐服务的同时保护用户隐私成为推荐系统新的关键问题之一。

1.2推荐系统的主要研究内容和研究方向包括：

（1） 推荐技术及算法研究：目前推荐技术主要包括基于内容的推荐技术和协同过滤推荐技术两种，其中协同过滤技术是当前研究的主流。随着研究深入，统计、数据挖掘等相关领域的技术在推荐系统中得到应用，包括关联规则挖掘，聚类分析，贝叶斯模型，序列模式挖掘等。通过应用相关技术，用于解决推荐系统某些难题，例如新用户问题，新项目问题，稀疏性问题等。目前，将数据挖掘相关技术同推荐技术相结合，提高推荐系统各方面性能是研究的热点之一。

（2）推荐质量研究：推荐质量是决定推荐系统能否成功应用的关键因素之一。由于推荐系统中用户评分数据具有高维和极端稀疏性，系统产生的推荐质量难以保证，从而使得系统如何有效地产生推荐变得相对比较困难。如何克服稀疏性，提高推荐质量是推荐系统研究的热点之一。另一方面，对于推荐质量评价指标本身，部分研究人员也进行了一定的研究。

（3）实时性研究：在绝大多数推荐系统中，数据都具有高维、海量的特点，推荐系统的可伸缩性和实时性要求越来越难以保证。如何有效满足推荐系统的实时性要求长期以来都是研究人员关注的焦点之一。

（4）推荐系统安全与用户隐私保护研究：由于推荐系统需要分析用户的习惯和兴趣爱好，这涉及用户的部分隐私问题，如何在提供推荐服务的同时有效地保护用户隐私，以及在提供推荐服务的同时有效地保障系统安全，都是值得进一步深入研究的内容。

2.国内外研究现状和发展水平

从算法上来说，1992年以前的推荐算法都是比较朴素的，要么基于手动设定的规则、要么基于分类用户的定制，然而他们都并不属于智能算法的范畴，因此在用户规模较大时很难产生太大贡献。Goldberg等学者(1992)在1992年正式提出协同过滤的概念，并将其引入到Tapestry系统。协同过滤的基本思想是，人们会根据过往的行为而对现在的选择做决定：过往的行为不仅仅指某个人自身的历史行为记录，还包括他所在的整个群体中其他与这个人有关联的人的行为。协同过滤算法能通过群体的力量来发现用户的潜在爱好、习惯或者预测用户对某一个特定项目的评分，自提出以来，它一直是推荐系统中尤为关键的算法，然而它往往并不是单独使用，而是与同类似基于内容的过滤算法、基于知识的过滤算法或者基于社交的过滤算法等联合使用，一个典型的例子就是谷歌的google news新闻系统，它主要采用协同过滤与基于内容推荐的混合推荐模型。基于内容的过滤算法(Content．based filtering)(Lang 1995，Salter and Antonopoulos 2006)最初用来针对个人或团体的信息过滤，例如对个人过滤垃圾邮件、对儿童过滤不良信息等。基于内容的推荐系统基本思想是：分析用户过往评价过的项目的描述与一个新项目的描述，如果描述类似而用户以往评价很高则将其推荐给用户，否则不推荐。例如用户曾买过一件特征为“女性、中等价位、清新、全棉、连衣裙”的商品并给出了很高的评价，那么一件新的同样特征的商品就很可能会推荐给用户。然而基于内容的推荐系统对项目的特征表示是困难而局限的，尤其对影视等文件自动表示困难，亦不能为新用户进行推荐。

发展到今天，推荐的技术多种多样、百家争鸣，针对不同的应用场景各有优劣。根据假设不同，可分为上段提到的基于协同过滤的推荐、基于内容的推荐，还有基于用户特征(统计特征，如性别、年龄、国籍等)的推荐(Demographic filtering)(Knflwich 1997，Pazzani 1999，Porcel，Tejeda．Lorente et a1．2012)、基于知识的推荐(Knowledge—based filtering)(Bridge，G6ker et a1．2005，Ricci，Cavada et a1．2006)．、基于关联规则的推荐(Association Rule．Based filtering)(Agrawal and Srikant 1994，Savasere，Omiecinski et a1．1995，Sarwar,Karypis et a1．2000)，更有大量的混合推荐算法(Hybrid filtering)(Burke 2002，Porcel，Tejeda．Loreme et a1．2012)等。基于方法的不同，推荐算法又可以分为基于模型的推荐(Model．based)和基于内存的推荐(Memory．based)。前者利用模型，如贝叶斯网络(Bayesian．network)、神经网络(Neural．network)等模型学习规则进行推荐；后者主要使用“用户．项目评分矩阵”计算相似度进行推荐。

3.推荐系统算法

3.1算法综述

推荐系统的起源与众多相关领域的广泛工作相关，包括计算机科学、网络与通信、统计学、机器学习、数据挖掘，以及认知科学、近似理论、信息检索、预测理论，甚至是管理科学。到20世纪90年代中期，推荐系统发展成为一个独立的研究方向，此时，研究人员大量关注推荐问题，并认为推荐问题主要依赖于用户对项目的评价或评分。在推荐系统研究中，将用户对项目的评价转化为可以度量的等级评分，这样，推荐问题可以简化为预测目标用户对尚未观测到的项目的评分。在直观意义上，通常这种预测主要基于目标用户对其他项目的评分，以及其他一些相关信息。一旦能够预测目标用户对项目的评分，那么系统就能够向目标用户推荐那些具有相对较高预测评分的项目。

一般而言，推荐问题可以使用如下形式进行描述。设U是一个推荐系统中所有用户的集合，C是该系统中所有项目的集合，在推荐系统中，能够用于推荐的项目可以有多种，例如书籍、电影、电视节目、餐馆等等。设f 是一个度量项目c对用户u的效用的函数，即



其中，R是一个全序关系集合，用于表示用户对项目的评价级别，一般使用非负数。

对于推荐系统中的每个用户，我们希望推荐用户认为效用最大的项目，即：

                           (2.2)

在推荐系统中，项目对于用户的效用一般使用评分进行度量，它反映了用户对项目的偏好程度。例如，如果评分等级为1～5，张三对电影《Harry Potter》的评分为5，表示其非常喜欢这部电影；而李四评分为2的话，则表示其不太喜欢这部电影。一般而言，效用函数f 可以是任意形式的，具体依赖于相应的系统或具体的应用。

一旦能够预测出用户对尚未评价的项目的评分，根据公式(2.2)，就可以向用户推荐预测评分最大的项目。当然，也可以向用户推荐评分最大的前N个项目，形成Top-N推荐。

为了产生精确且有效的推荐，保证推荐系统的实时性要求，研究者提出了各种不同的推荐算法。从推荐系统采用的推荐技术来看，可以将推荐算法分为如下三类：

♦  基于内容的（Content-based）推荐：向目标用户推荐其过去比较偏好的项目；

♦  协同过滤（Collaborative Filtering）推荐：查看与目标用户兴趣相仿的用户，根据这些用户的偏好向目标用户产生推荐；

♦  混合式（Hybrid-based）推荐：将基于内容的推荐方法和协同过滤相结合，甚至引入其他领域的技术方法，用以产生推荐。

基于内容的推荐算法：

基于内容的推荐算法是根据信息的内容和用户偏好之间的相关性，向用户产生推荐。该方法运用用户以往对项目的偏好兴趣建立用户特征（User Profile），并对项目内容进行分析，评估项目与用户兴趣之间的相关性，进而判断并找出哪些项目可能是用户所感兴趣的，并将这些项目推荐给用户。

可见，在基于内容的推荐算法中，预测项目c对用户u的效用，是根据用户u对与项目c相似的其他项目 的效用评分获得的。例如，在对电影进行推荐的系统中，为了向用户u产生推荐，基于内容的推荐系统将分析用户u过去评分相对较高的电影的共性，即用户u过去喜好电影的共同特点，如导演、演员、流派、情节内容、发行公司等等内容，建立用户特征。进而，只将那些与用户特征相符合的电影推荐给用户u。

基于内容的推荐算法主要源于信息检索和信息过滤技术。由于信息检索和信息过滤技术多年来已经有大量显著的研究成果，同时目前基于文本的各种应用仍然广泛使用，因而现有的基于内容的推荐系统主要集中在基于文本的应用上，例如文档、Web站点以及新闻信息等。不过，这类推荐系统一般都对传统的信息检索和信息过滤技术进行了改进，主要是在系统中建立了用户特征（Profile），其中包括关于用户品位、偏好和需求等用户相关信息。这些用户特征信息可以显式地从用户那里直接获取，例如通过向用户进行提问，在用户的回答中获取相关信息和知识；也可以隐式地获取，例如从用户过去的行为模式中学习。在建立了用户特征之后，在推荐过程中，系统将度量用户特征与项目之间的相似性，进而决定向用户推荐的项目。

除了传统的信息检索方法以外，基于内容的推荐系统还引入了其他一些技术，主要是一些数据挖掘、机器学习领域的技术方法，包括Bayes分类器，聚类，决策树，人工神经网络等。有别于传统的信息检索技术直接度量用户特征与项目之间的相似性，这些方法运用统计学习或机器学习技术建立模型，进而通过模型预测推荐的项目。例如，用户对网页评价“相关”或“不相关”，基于这些用户评价后的网页，文献[27]使用了朴素Bayes分类器对尚未评价的网页进行分类，产生推荐。虽然使用基于内容的推荐算法，可以依据使用者过去的偏好，推荐出符合用户喜好习惯的项目，但是此方法有以下限制：

（1）  所能分析的项目内容仅限于能够用一系列的特征集合来表示的信息，而无法有效处理声音、图片、艺术品、影像等多媒体信息。

（2）  用户仅仅能够接收到与过去喜好类似的推荐项目，而无法找出与过去体验有所不同，同时又具有潜在意义的新颖性推荐。

（3）  无法处理品质、风格或观点。以文章为例，若两篇文章的主题相同，但其内容品质有所差别的时候，此方法无法有效分辨。

下面主要介绍协同过滤算法：

John S Breese等根据协同过滤采用的算法，将其分为两种主要的类型：基于内存的算法（Memory-based）和基于模型的算法（Model-based）。

 基于内存的协同过滤算法：在推荐过程中，计算分析用户历史记录，找出与用户偏好相似的近邻用户的集合，其中最常用的方法为近邻法。也就是说，预测用户u对项目c的评分ruc，通常是根据其他用户（一般是N个最相似的用户）对同一项目c的评分综合考虑计算出来的：



其中，表示对项目c已经进行了评分，并与用户u最相似的N个用户组成的集合。N的取值范围可以是1到整个用户集合的大小。aggr是综合用户集合中评分，预测用户u对项目c评分ruc的函数或方法。

 基于模型的协同过滤算法：其主要是将使用者历史纪录，通过统计方法或机器学习方法来构建使用者偏好模型，进而利用偏好模型来产生推荐，目前使用的方法包括：潜在语义索引（Latent Semantic Indexing，LSI）、关联规则挖掘（Association Rule）、Bayes网络或回归分析（Regression analysis）等。

此外，George Karypis依据协同过滤技术所使用的事物的关联性，将其分为两类：

（1）User-based CF：其核心思想是假设人与人之间的行为具有某种程度的相似性，即购买行为类似的顾客，会购买类似的产品。GroupLens就是属于此类系统。

（2）Item-based CF：其主要思想是假设项目间具有某种程度的相关性，即顾客在购买时，其所购买的产品通常具有关联性，如顾客在购买电子游戏机时，通常会购买电池及游戏卡盒。

迄今为止，协同过滤技术是个性化推荐系统中应用最为成功的技术。其最大的优点在于不需要分析项目的特征属性，对推荐对象没有特殊的要求，因而能够处理非结构化的复杂对象。与基于内容的推荐算法相比，协同过滤算法的主要优点如下：

（1）  在协同过滤中，用户在信息流中决定对一个项目的兴趣或质量，因而可以过滤一些使用计算机难以分析的项目，如：电影、音乐、电视节目、感想、评论等等。

（2）  协同过滤系统可以通过测试某一项目满足用户需要的程度，来增强信息过滤系统的性能。人们可以分析某一项目的质量或者其它的内在品质，但是计算机却难以做到。一个基于内容的检索过程可以检索出所有斯皮尔伯格导演的电影，但是如果将基于内容的过滤系统与协同过滤系统相结合，则系统可以仅仅返回斯皮尔伯格导演的、确实拍得好的电影。

（3）  协同过滤系统有时可以产生一些令人意想不到的、新颖性的推荐结果，而不仅仅是用户原来就已经想到的推荐项目。协同过滤系统主要是根据用户的相似性来推荐资源，这与基于内容的推荐技术有所不同，它比较的是用户描述文件，而不是资源与用户的描述文件。由于是根据相似用户进行推荐，所以有可能为用户推荐出新的感兴趣的内容，或是潜在的兴趣点。

协同过滤技术在理论研究和实际应用上都取得了很大的发展，但是在以下几个方面仍然存在着很大挑战：

（1）  精确性（Accuracy）问题，即提高对用户的推荐质量的挑战。用户需要一个可以让他们感到信任的推荐系统来为他们提供项目的推荐，如果一个系统推荐的项目经常不符合用户的需求，那么用户很快会失去使用该推荐系统的兴趣，从而影响推荐系统的应用与推广。因而精确性问题向来是研究人员及系统使用者研究和关注的重点。

（2）冷启动（Cold Start）问题，也称为第一评价（First Rater）问题，分为新项目（New Item）问题和新用户（New User）问题。如果一个新项目没有人去评价它，则该项目肯等得不到推荐，推荐系统就失去了作用，这是采用协同过滤技术的推荐系统中一个突出的问题。同样，如果一个新用户从来没有对系统中的任何项目进行过评价，则系统就无法获知其兴趣偏好，进而无法确定其近邻用户，也就无法对其进行推荐。

（3）  稀疏性（Sparsity）问题，在很多推荐系统中，由于用户和项目的数量都非常巨大，相对于进行推荐预测的所需要评分，已经获得的评分数量非常有限。在一些大型系统如Amazon.com网站中，用户最多不过就评分了上百万本图书中的1％～2％。这就造成评分数据矩阵非常稀疏，难以找到相似用户集，进而导致推荐效果大大降低。

3.2基于降维的推荐算法

协同过滤推荐算法基本思想是通过计算目标用户与各个基本用户对项目评分之间的相似性，搜索目标用户的最近邻居，然后根据最近邻居的评分数据对目标用户产生推荐，即目标用户对未评分项目的评分可以通过最近邻居对该项目评分的加权平均值进行逼近，从而产生推荐。用户数目和项目数量急剧增加，用于预测评分的数据的维度相应地急剧增加，由于需要计算目标用户与每个基本用户之间的相似性，传统的协同过滤算法在线搜索目标用户最近邻居将成为系统的速度瓶颈之一。同时，随着用户评分数据的稀疏性增加，推荐质量也会逐步下降。

针对这些问题，人们对协同过滤系统与其他方法的混合进行了研究。这些研究主要集中在以下几个方面，统计模型或贝叶斯网与协同过滤系统相结合；线性回归模型与协同过滤系统相结合；关联规则挖掘与协同过滤系统相结合；其他方法与协同过滤系统相结合。但是这些混合算法普遍存在模型相对复杂，不易解释等缺陷。此外，人们还对协同过滤系统与降维技术的结合进行了一些研究。非负矩阵分解（NMF）是一种新的矩阵分解算法，具有算法相对简单，易于解释等特点。提出了一种基于NMF的协同过滤推荐算法。该算法通过将基本用户评分矩阵进行非负矩阵分解，获得相关的基矩阵和投影矩阵，进一步计算目标用户对于基矩阵的投影向量，根据投影矩阵搜索最近邻居，然后产生推荐。由于离线必要的数据预处理及NMF的降维作用，使得在线的计算工作量相对减小。因而该算法在一定程度上解决了高维稀疏性对推荐系统的影响，以及传统协同过滤算法的速度瓶颈问题。

给定推荐系统数据源D=(U,R,C)，原始用户数据矩阵总能通过预处理将其转化成为非负矩阵，从而满足NMF算法的基本要求。因而，不失一般性，假设是非负矩阵。本文提出的基于NMF的协同过滤推荐算法如下：

输入：数据源D=(U,R,C)，目标用户ua。

输出：目标用户ua相应的推荐。

Step1：通过对原始评分矩阵的转置矩阵进行非负矩阵分解获得基矩阵和投影矩阵。

Step2：根据基矩阵W，可以计算目标用户ua评分向量对基本矩阵W的投影向量ha

Step3：计算ha与投影矩阵H各行之间的欧氏距离，将其中距离最小的前k个用户组成目标用户ua的最近邻居集合NSa。

Step4：根据ha和公式预测目标用户ua对项目的评分，并产生相应的推荐。

算法的Step1中r是系统实现时需要确定的参数，它是基本矩阵W中基向量的个数，r值的选取通常满足。当m和n值比较大时，r<<m 以及r<<n 一般总是成立的。

同时，Step1可以离线进行操作，从而减少了在线数据运算的时间。

针对传统协同过滤推荐算法所遇到的参与运算的数据的高维及稀疏性问题，以及相应的推荐生成速度瓶颈问题，本文将非负矩阵分解引入推荐系统中，提出了一种基于NMF的协同过滤推荐算法。相对于其他矩阵分解方法，NMF无需计算矩阵特征值和特征向量，具有简单迭代、收敛速度快、存储容量小等优势，因而更加适合在推荐系统中使用。在推荐系统中通过应用NMF算法，将原始评分数据分解为基空间，以及在此空间上的投影编码。系统在线目标用户的最近邻搜索在基空间上进行，从而避免了推荐系统的高维和稀疏性的不良影响，提高了推荐精度和推荐的生成效率。实验结果表明，该算法不仅能够显著提高推荐生成速度，而且能够提高推荐质量。当然基于NMF的协同过滤推荐算法还有一些问题需要进一步研究，例如在非负矩阵分解中，参数r选取的原则，以及其对推荐质量的影响等。

目录

	第1级	1

	第2级	2

	第2级	3

	第1级	4

	第2级	5

	第2级	6

Tapestry是最早的协同过滤推荐系统，它的产生对推荐系统的发展有甚远意义。Tapestry是20世纪90年代初美国Xerox公司的Palo Alto研究中心研发的邮件过滤推荐系统，它能帮助用户过滤电子邮件并推荐新闻。Tapestry的用户可以对阅读过的文章发表评论，系统根据评论、用户的偏好对用户进行推荐。但是作为早期的推荐系统，Tapestry并不能自动的推荐，需要对用户进行繁冗的查询，同时还需要用户之间有明确的关系，这在用户规模稍大时就难以实现，因此只能用于小规模用户的场景。

Cinematch系统是Netflix公司的电影推荐系统，Netflix公司是一家美国在线影片租赁商，在美国、加拿大提供互联网流媒体播放和定制DVD、蓝光光碟在线出租业务。Netflix用户可以对看过的电影进行评分，而Cinematch系统则会根据用户过往的评分记录推测该用户对全部电影的评分，从而为用户推荐高分电影。Netflix公司对推荐系统更大的贡献在于他们于在2006年启动了Netflix大奖赛，这个机器学习和数据挖掘的比赛旨在解决电影评分预测问题，能将Cinematch系统的准确率提升10％的获胜团队或个人将能得到一百万美元的大奖。

Youtube是目前世界上最大的视频分享网站，用户能自由的上传、分享、下载、观看各类视频。Youtube的个性化视频推荐算法获得了美国国家电视艺术与科学学会(NATAS)授予的2013“技术与工程艾美奖”，因为它能从海量视频中发掘用户爱好，提供深度个性化体验以延长用户注意力。YouTube的推荐算法形成并上线最早是在2008年，这是网站本身诞生后的第三年，也是被谷歌收购后的第二年。新上线的推荐系统会在Youtube主页和右侧的个人视频页上，向用户推荐其他视频以供观看。算法设计师Goudreau说，在2008年末Youtube的推荐系统会让网站每天增加了“成千上万小时”的视频观看量，今天，这个数字则变成了数百万。

Amazon的推荐系统被很多学者认为是当今最成功的推荐系统。Amazon成立于1995年，是美国最大的电子商务公司，据VentureBeat统计，Amazon的推荐系统为其提供了35％的商品销售额(刘建国，周涛et a1．2009)。这个数字曝光后引来了无数学术界和工业界的目光，也大大推动了学者们对推荐系统研究的热情。Amazon表示在该网站上购物的人群中，仅有16％具有明确的购物意图，因此推荐系统能很好的引导剩下84％的人群消费。图1．4是Amazon的图书推荐系统的实例，在搜索“具体数学”后，网站会推荐《组合数学》、《离散数学》等相关图书。

Google News是谷歌公司开发的一款Web新闻聚合器，由Google首席工程师克里希纳·巴拉特(Krishna Bharat)创造与领导开发，2006年正式发布。Google News是一个具有代表性的资讯推荐系统，能发现用户对不同类别新闻的偏好程度，如喜欢国内还是国际，喜欢军事、体育、经济、社会或者科技，根据用户偏好给用户推荐合适的新闻。过去google使用纯协同过滤的方法进行推荐(主要使用的技术是LSH／Minhash，PLSI和CO．visition)，这种方法比纯粹推荐流行新闻在结果上提高了38％。2010年后，google根据新闻的特点——时效性要求高，更新快，发现协同过滤难以第一时间发现缺少用户标记的新闻，于是引入了基于内容的分析，建立了一个混合模型。从实际效果看，新的模型提高了30．9％的点击率，同时提高了14．1％的网站访问率。

MovieLens是一个更偏向于科研目的的推荐系统和虚拟社区，它的主要目的是使用协同过滤技术，向用户推荐电影。在一个新的用户开始使用MovieLens系统前，他首先需要对系统中任意15部电影进行评分，然后系统将预测他对系统上所有电影的打分，然后根据分值推荐电影。该系统是1997年由该网站是GroupLens实验室创立，后者隶属于明尼苏达大学大学计算机系。在今天MovieLens提供的数据集是学术界最广泛使用的推荐算法评价数据集，在该数据集上通过交叉验证得到的平均绝对误差(MAE)和均方根误差(RMSE)是评价算法优劣的一个重要标准。





23



22